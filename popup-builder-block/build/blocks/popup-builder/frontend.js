(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=function(e){const t=`; ${document.cookie}`.split(`; ${e}=`);return 2===t.length?t.pop().split(";").shift():null},o=function(e,t,o){const n=new Date;n.setTime(n.getTime()+60*o*60*1e3);const i=`expires=${n.toUTCString()}`;document.cookie=`${e}=${t}; ${i}; path=/`},n=window.wp.hooks,i=(e,t)=>{let o=e.getAttribute("id");o=o.replace("popup-builder-","");const{entrAnimation:n,exitAnimation:i,animationDuration:r,type:p}=t||{},s=e.querySelector(".popup-builder-container");s.classList.remove(`${n}`),s.classList.add(`${i}`),s.classList.add("reverse"),setTimeout((()=>{["popup","full-screen"].includes(p)&&t?.preventScroll&&(window.parent.document.body.style.overflow=""),e.classList.remove("popup-builder-modal--open"),s.classList.remove(`${i}`),s.classList.remove("reverse"),window.frameElement&&window.frameElement.remove()}),1e3*r)},r=window.wp.apiFetch;var p=e.n(r);const s=async(e,t)=>{let n=e.getAttribute("id");n=n.replace("popup-builder-","");const r=e.querySelector(".popup-builder-container"),s=e.querySelector(".popup-builder-close"),u=window.parent.window.getComputedStyle(e),{left:d,right:l,top:c,bottom:a}=u||{},{outsideClose:b,entrAnimation:m,animationDuration:w,type:v}=t||{},y="display:flex;position:fixed;z-index:9999;border:none;";window.frameElement&&(window.frameElement.style=y+"height:100%;width:100%;top:0;left:0;"),e.classList.add("popup-builder-modal--open"),["popup","full-screen"].includes(v)&&t?.preventScroll&&(window.parent.document.body.style.overflow="hidden");const g=e.getBoundingClientRect(),f=e=>"0px"===e?0:void 0;if(!["popup","full-screen"].includes(v)&&window.frameElement){let e="100%";"slide-in"===v&&(e=g.width+20+"px"),window.frameElement.style=y+`height:${g.height+26}px;width:${e};bottom:${f(a)};left:${f(d)};right:${f(l)};top:${f(c)};`}m&&(r.classList.add(`${m}`),r.style.setProperty("--pbb-popup-animate-duration",`${w}s`),setTimeout((()=>{r.classList.remove(`${m}`)}),1e3*w)),s&&s.addEventListener("click",(()=>i(e,t))),b&&e.addEventListener("click",(o=>{const n=e.querySelector(".popup-builder-content");n&&n.contains(o.target)||i(e,t)})),(s||b)&&window.parent.document.addEventListener("keydown",(function(o){"Escape"===o.key&&i(e,t)})),p()({path:"/pbb/v1/popup/logs",method:"POST",data:{postId:Number(n)}}).then((e=>{if("success"===e.status){const{logId:t,userDetails:n}=e.data;o("pbb_user_info",JSON.stringify(n),8760),sessionStorage.setItem("pbb_logs",t),o("pbb_country",n.country,1)}}))},u=e=>{const{popupID:r,popupAttributes:p}=(e=>{const t=JSON.parse(e.getAttribute("data-settings"));return{popupID:e.getAttribute("id").replace("popup-builder-",""),popupAttributes:t}})(e),{openTrigger:u,pageLoadDelay:d,scrolledToValue:l,userInactivityTime:c,scheduleDateTime:a,displayVisitor:b}=p||{},m=()=>{"once-a-day"===b?.frequency?"true"!==t(`pbb_viewed_${r}`)&&(o(`pbb_viewed_${r}`,"true",24),s(e,p)):(0,n.doAction)("popup-builder.checkFrequency",e,r,p,t,o,s)},w=()=>{b?.convertionOff&&"true"===t(`pbb_conversion_${r}`)||("new"===b?.visitor?"true"!==t("pbb_new_visitor")&&"true"!==t("pbb_old_visitor")&&(o("pbb_new_visitor","true",24*b?.newDayCount),o("pbb_old_visitor","true",24*b?.returnDayCount),s(e,p)):"return"===b?.visitor?"true"!==t("pbb_old_visitor")?o("pbb_old_visitor","true",24*b?.returnDayCount):m():(m(),"true"!==t("pbb_old_visitor")&&o("pbb_old_visitor","true",24*b?.returnDayCount))),"true"===t(`pbb_conversion_${r}`)&&o(`pbb_conversion_${r}`,"true",8760),"page-scroll"===u&&window.parent.window.removeEventListener("scroll",v),"inactivity"===u&&window.parent.document.removeEventListener("mousemove",g),"page-exit"===u&&window.parent.document.removeEventListener("mouseout",_)},v=()=>{const e=window.parent.document.documentElement.scrollHeight-window.innerHeight;window.parent.window.scrollY/e*100>=l&&w()};let y;const g=()=>{clearTimeout(y),y=setTimeout((()=>{w()}),1e3*c)};let f=!0;const _=e=>{e.clientY<=0&&f&&(w(),f=!1)},h=()=>{"page-load"===u?setTimeout((()=>{w()}),1e3*d):(0,n.doAction)("popup-builder.checkOpenTrigger",e,p,_,v,g,s)};a?(0,n.doAction)("popup-builder.checkTimeAndShowPopup",e,p,h,i):h()};window.addEventListener("load",(()=>{const e=document.querySelectorAll(".popup-builder-modal");if(e.length>0)for(const t of e)u(t)}))})();