(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.apiFetch;var o=e.n(t);const n=(e,t)=>{let o=e.getAttribute("id");o=o.replace("popup-builder-","");const{entrAnimation:n,exitAnimation:i,animationDuration:s,type:r}=t||{},p=e.querySelector(".popup-builder-container");p.classList.remove(`${n}`),p.classList.add(`${i}`),p.classList.add("reverse"),setTimeout((()=>{["popup","full-screen"].includes(r)&&t?.preventScroll&&(window.parent.document.body.style.overflow=""),e.classList.remove("popup-builder-modal--open"),p.classList.remove(`${i}`),p.classList.remove("reverse"),window.frameElement&&window.frameElement.remove()}),1e3*s)},i=function(e,t,o){const n=new Date;n.setTime(n.getTime()+60*o*60*1e3);const i=`expires=${n.toUTCString()}`;document.cookie=`${e}=${t}; ${i}; path=/`},s=async(e,t)=>{let s=e.getAttribute("id");s=s.replace("popup-builder-","");const r=e.querySelector(".popup-builder-container"),p=e.querySelector(".popup-builder-close"),a=window.parent.window.getComputedStyle(e),{left:l,right:d,top:c,bottom:u}=a||{},{outsideClose:m,entrAnimation:b,animationDuration:g,type:w}=t||{},f="display:flex;position:fixed;z-index:9999;border:none;";window.frameElement&&(window.frameElement.style=f+"height:100%;width:100%;top:0;left:0;"),e.classList.add("popup-builder-modal--open"),["popup","full-screen"].includes(w)&&t?.preventScroll&&(window.parent.document.body.style.overflow="hidden");const v=e.getBoundingClientRect(),y=e=>"0px"===e?0:void 0;if(!["popup","full-screen"].includes(w)&&window.frameElement){let e="100%";"slide-in"===w&&(e=v.width+20+"px"),window.frameElement.style=f+`height:${v.height+26}px;width:${e};bottom:${y(u)};left:${y(l)};right:${y(d)};top:${y(c)};`}b&&(r.classList.add(`${b}`),r.style.setProperty("--pbb-popup-animate-duration",`${g}s`),setTimeout((()=>{r.classList.remove(`${b}`)}),1e3*g)),p&&p.addEventListener("click",(()=>n(e,t))),m&&e.addEventListener("click",(o=>{const i=e.querySelector(".popup-builder-content");i&&i.contains(o.target)||n(e,t)})),(p||m)&&window.parent.document.addEventListener("keydown",(function(o){"Escape"===o.key&&n(e,t)})),o()({path:"/pbb/v1/popup/logs",method:"POST",data:{postId:Number(s)}}).then((e=>{if("success"===e.status){const{logId:t,userDetails:o}=e.data;i("pbb_user_info",JSON.stringify(o),8760),sessionStorage.setItem("pbb_logs",t),i("pbb_country",o.country,1)}}))},r=(e,t)=>{e&&!function(e){const t=`; ${document.cookie}`.split(`; ${e}=`);return 2===t.length?t.pop().split(";").shift():null}(`pbb_conversion_${t}`)&&((e,t)=>{const n=Number(sessionStorage.getItem("pbb_logs"));o()({path:"/pbb/v1/popup/logs",method:"PUT",data:{id:n,...e}}).then((e=>{t&&t(e)}))})({converted:!0,refferer:window.parent.document.referrer},(e=>{"success"===e.status?i(`pbb_conversion_${t}`,"true",8760):console.error("Error updating conversion count:",e.message)}))};window.addEventListener("load",(()=>{const e=document.querySelectorAll(".pbb-btn"),t=(e,t)=>{const o=document.getElementById(`popup-builder-${e}`),n=JSON.parse(o.getAttribute("data-settings"));t(o,n)};for(const o of e){const e=JSON.parse(o.getAttribute("data-settings")),{istrackConversion:i,clickEvent:p,openCampaign:a,closeCampaign:l}=e||{};(["openCampaign","closeCampaign"].includes(p)||i)&&o.addEventListener("click",(()=>{const e=o.closest(".popup-builder-modal"),d=e?.id.replace("popup-builder-","");r(i,d),"openCampaign"===p&&a?(t(d,n),t(a,s)):"closeCampaign"===p&&l&&t(l,n)}))}}))})();